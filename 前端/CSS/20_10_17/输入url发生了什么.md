
<!-- vim-markdown-toc GitLab -->

* [输入 url 到页面显示大概过程](#输入-url-到页面显示大概过程)
	* [DNS 解析](#dns-解析)
		* [递归查询](#递归查询)
		* [迭代查询](#迭代查询)
		* [两中查询方式的区别](#两中查询方式的区别)
	* [TCP/IP 三次握手](#tcpip-三次握手)

<!-- vim-markdown-toc -->

## 输入 url 到页面显示大概过程

1. DNS 解析
2. TCP 三次握手
3. 解析 THML 文档
4. TCP 四次挥手

### DNS 解析

获取域名对应的 ip 地址。

#### 递归查询

浏览器询问本地 DNS 服务器，获取 ip 地址的过程

1. 查询浏览器缓存是否含有解析记录
2. 查询本地 .hosts 文件是否含有域名映射
3. 查询本地 DNS 解析器缓存是否含有域名映射
4. 尝试让本地 DNS 服务器进行解析
5. 查询本地 DNS 服务器缓存是否含有域名映射

#### 迭代查询

本地 DNS 服务器询问远程 DNS 服务器获取 ip 地址的过程

**转发模式**   

1. 本地 DNS 服务器将域名解析请求发送给某 DNS 服务器 A 进行解析
2. A DNS 服务器发现这个域名是自己管理的，那么返回管理下一级域名的主机地址给本地 DNS 服务器
3. 本地 DNS 服务器访问返回的主机地址，重复以上操作，直到查询到完整域名所对应的 ip。
4. A DNS 服务器发现不是自己管理的，则将解析请求发送给上一级 DNS 服务器 B 进行解析，如果上一级也无法解析，则返回给上上级，直到根 DNS 服务器停止
5. B DNS 服务器将管理下一级域名的主机地址按原路径返回给 A DNS 服务器
6. A DNS 服务器将地址返回给本地 DNS 服务器
7. 本地 DNS 服务器访问返回的主机地址，重复以上操作，直到查询到完整域名所对应的 ip。

**非转发模式**   

非转发模式除了第一步是将解析请求发直接发送给根 DNS 服务器外，其他步骤与转发模式一样。

#### 两中查询方式的区别

递归方式会返回最终查找的结果；迭代查询不会直接告诉查询结果，只会返回下一次要访问的服务器地址，直到找到最终结果。

### TCP/IP 三次握手

